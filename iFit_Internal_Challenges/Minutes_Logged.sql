WITH testers_actuals AS (
	SELECT ul.*
	FROM unique_logs ul 
	JOIN prodmongo.users on ul.user_id = users._id
	WHERE CONVERT_TIMEZONE(users.personal__tz,"start") BETWEEN '2020-09-07' AND '2020-09-13'
	AND ((extract('hour' from CONVERT_TIMEZONE(users.personal__tz,"start")) >= 08 
		OR extract('hour' from CONVERT_TIMEZONE(users.personal__tz,"start"))) < 17)
	AND ul.user_id IN ('50b44371c3fff42c55000a8c',
'50b45078c6d38dcb55001011',
'50b4dc2ec6d38dcb5500e514',
'50eb63326b32cbd8040002ab',
'542ed2e5450d434076e3a6d6',
'546b79e8a32103d74dcad5c5',
'5488d227b38dd6457aeb070c',
'5806c2b53654451e000557f8',
'5843a6e7ec171f2e00c674c0',
'596cf3f8f3ba830033ba839d',
'5978cc68ad923500f2bf5c16',
'598a13bfe3cd1c0029365654',
'5991f23ecca01102cdb079f3',
'59e6066dd300d9011497a153',
'5a1326ce1079b000464e30e6',
'5a2dd0b0b61e3f0044d48176',
'5a9439e2ad7cac03792f32c7',
'5b734aa8d077b900758d0aea',
'5b7480a56c3b1200483883d1',
'5baab8ed50ff85002f3504de',
'5bb7bfcf3bbb9e002db04fcf',
'5bc75bc007a43c00a421cbe8',
'5c17d64293f427052fb60a78',
'5c7023853d358401ec988e15',
'5c756c6db4ef9e00d3dcb089',
'5c770899d97440010901e488',
'5c82e0c9b0e178040fadb2ec',
'5c8693d9ded5c6002b36c38c',
'5cc341ce33c8e6003195c8c7',
'5cc9cfb1202f2a00329b11f5',
'5d67f26e1f6867002c6cd2fd',
'5d97643091a8d60539ae41ac',
'5dfbb5e318c1380178cf515a',
'5e13e2d0a7be33003417b023',
'5e1e01ac97501d002966be14',
'5e33590648c393002e51d542',
'5e3af98c686c310030efed6d',
'5e541bbe59f9ab0034c27c91',
'5e541fb3e8cbb8002ea4f10b',
'5e73c43956abda01a64d72d5',
'5e78cb4f1d94060033a684b1',
'5e84e26bfa1c0800351fabc9',
'5eac8f26848d710034072b66',
'5eacbdc786e8ad00b87711af',
'5eacca82f0ee19007f84c1cd',
'5eb45d36b5e6b2012940607f',
'5eb587acd2988c00a5cf1f96',
'5ed9739ea0eb36007925866c',
'5f0cbcb5bbfc4e003378c9dc',
'5f0f1d5169c9b9010ded2bea',
'5f11e6831e7f360040804a13',
'5f1ce77e74a0c8021e40d3e0',
'5f2afda16d9eb6002cfeef89',
'5f3401907b604f00302e910c',
'5b5a20a4b7793e015d3a43a8',
'5de6c9134502610038ae93e9',
'5dcaf6061bc7a000327cd21c',
'557b749bb4f63a4948a2a6fc',
'55c9382b207502c770fbd8eb',
'589359ea0c846d1f0069c0ff',
'596fc3265a6443005450e397',
'5976bef482bbc903bc79a640',
'5a1353f344320b00434ee03a',
'5a66243dc70d6c01514f9d6e',
'5b2182290c66d1002f9f49a5',
'5b686eea5aaec001915a6d56',
'5b80386cf0423501c8378d9b',
'5c06f8c7e2a90c00f4c75005',
'5c13f6b4341fab00d6dffeea',
'5c479114b8d7e7075c0f5059',
'5c86c228fc91410108233dcd',
'5cf2b529833c3a002aa6e597',
'5cfe85d9a2117304e39835c2',
'5d011f6642f90501bb770c66',
'5d320394c74e2c083f73f42a',
'5d8297cfbd32ae002cee30ab',
'5d82b08aecb8880206961a5f',
'5d9ca269c6f25b0f092a8440',
'5de811ad833785012d106a42',
'5dfd2f93df957f003a8ef56d',
'5e1cc1a4b520c40030580ec0',
'5e3b82d71480b603171c2ee8',
'5e4f0cbdcb5ca40493fb925f',
'5e540a54c05a0a0379100694',
'5e85ffdc73004700351b9127',
'5e8b4710e91ae90079a32027',
'5e963a276c535400cb1154dd',
'5e9f6f35a27531009fedf4e7',
'5ea4b39fa7a178002fa23b78',
'5eb0563a95f3de0035e22dc7',
'5f0ca3fda10ad905353f88d9',
'5f33ff77b8a08c0115437f55',
'50b67c5e13d2c7c27a0000d6',
'5f3ffa92fd2520002ecbe105',
'5b71eb434b608f0058dd9975',
'542579a53a42a06605db7c81',
'544686ad524a7e9e261670b8',
'560aeb546217131e0014acc7',
'58485a7fa5d7e81e00f4378d',
'5938310f1193b40a540aa569',
'5983474d6ae4340124734984',
'59d7b60af9954900418f216e',
'5a64d745d04a0e0169fafe68',
'5a676eab98494e005b4b1347',
'5a6e057d506bdd01fce6ed7c',
'5a94a235b42bad00279c0f45',
'5b2ea4cb7aa6cf0092120085',
'5b74820d6c3b120048388a4c',
'5b7f038d775d0f003e8939ac',
'5b96ae9bc99c730029fb4c17',
'5bedf6d9b4c0bd0061c9188b',
'5c12cac22ecb3a002ea16e4e',
'5c153cb45e5d96029fdc4f61',
'5c18365841d688022f25bc11',
'5c3532ac376bbd00316c8856',
'5c64519d226cb001da873760',
'5c6c7d21c572d0002b765abc',
'5c701f5334aed801d3062d55',
'5c7d7e4d2a1327008005f97b',
'5ca254e414ecac039e17b99a',
'5cb63f1b2ab5f7022b44193d',
'5cda035678e733018bdc6df6',
'5cdb1dda539659003274d668',
'5ce6e8e0d41647002f6355e3',
'5d016f86fc110b02338b75be',
'5d353ccc963af502cefcf21c',
'5d49af4f664bb100284cdae9',
'5d5db92d2a4fbf03dd2d0528',
'5d697b85e60a1c03732d4f59',
'5d6e7bb6b762e60875b3e367',
'5d81463a3429c20583be1b8a',
'5d82a0822f8fd1017857be68',
'5dd59a32413d2f002e8d2ffb',
'5e1ddd272bfb8d00a2856964',
'5e6a77b1a229b603d9ba8610',
'5e6b9c12e469e303011c00e1',
'5e73e8d8064332003536afeb',
'5e84d8248b7380003a5d0ff9',
'5e8ccbcedb6d35030216445b',
'5e94b10a993cb600a52b8e0a',
'5e96017427177b012985b7d3',
'5eac4d99e645f801ff6c2355',
'5eb2fbe080e274003169af2d',
'5eb47010a9a258022dad566f',
'5eb58ae38f515800355efb31',
'5eb9a93f8a55c5003406cd61',
'5ecfe78aa31d3400bbbcc4e8',
'5eda7338c98034008ce5139a',
'5eecc7a5cc484a002de353b3',
'5f04ea9dc36d7f003446bd7c',
'5f0e06864abc29003442a388',
'5f3592741a0c88002ddea711',
'5f359a0b9c7e590034cfa279',
'5c6c56aa556d8400857271c9',
'59a6eeb9185507003f99ddef',
'5d27e26f9bf4ad002d2ad1b0',
'59efaafd72fad6003edab7ce',
'5bc8ea39690fce002b5fa018',
'50b43825a3dffd9355000493',
'50b44e2a9ecf9f2855001075',
'531de72fd3869b4a6c000a85',
'53ea46431cc089b609ee3207',
'5437ec44ea8d3d8a099cea7e',
'567c975fa9058b26009940d1',
'594ab373632b6d00347e09d4',
'59911ec1fb12db01d4eb05f2',
'5a67680f60ff0d00452f5eac',
'5a85e7c825e60e002a3d3d2a',
'5bd727cad7d5fe00983c1fdd',
'5c1d3c41ef7f57003038118a',
'5c64555ca5f031021c7a4fa1',
'5cab66f744074303d7672cef',
'5cc726c833c42e078d699162',
'5d011fa488bb240175347c55',
'5d2defca873f1f0030863d82',
'5d5af19496c2f800324d3dbd',
'5d6e8a1e83e9a50753b34b0c',
'5d82a0191592ba017bcbc54b',
'5d85052f8b43f400736b6b0a',
'5dcb2d872f1605021defa6a5',
'5dfd28ed59bbfc002ea4f055',
'5e1cb2a8032dc005062a132d',
'5e386abea9de4d00ecdfbc99',
'5e78ccc968ef2e06429fd5b9',
'5e8754c1c3c3ba01420156fb',
'5e96290cfacfab002d7c94cf',
'5ed9617f3d25db0035a41916',
'5ee1036f5381d501882ca3cd',
'5f0374f9517c3f002fb48900',
'5f04eea876f7c1003179ab01',
'5f11e6b9283c42003a197ed2',
'5f318bce4b80090182151930',
'5f36f73eb2bc25002e0f6ea5',
'5f36f97b5cd824012db9f2ca',
'5c003c0ee1e143003033d8b5',
'5d20b91390570d021735b981',
'5cb551e40c4aaa0030b56fc5',
'5d2e2a5d818a2300314e992f',
'50b4dcc4deffcc5f61004221',
'53dbbe18033c6f5f69899a1b',
'56f46dd803c4191e00950b31',
'5314d11572d4fb240900043c',
'5372379cfc6312900d00413b',
'56aa878923ba692100faf660',
'578d3f0bbb75eb210040ed4f',
'5873bf6e3eee9721008ab4a4',
'5893520295edb52500060845',
'593cacdce9dbdf00467fc4c4',
'599738ab1bd46f0047120c60',
'5b97f9c5608d7f0055d68877',
'5baa7cf7867eb100292a7c78',
'5bd0b67a7a4ece002b095b84',
'5bdccad3a38f960029bf2a41',
'5bedf5104cd6a500325cdeb3',
'5c702613afb84d0210c484d6',
'5c92b3436e1d7100841bc577',
'5c9e88f50fc73f030ed4fd13',
'5cf549fa3b47a800325dbfd2',
'5d3736a44e604f003984e826',
'5d49dd731944a700a5304f4e',
'5d5d7419fd2d5f030867abdd',
'5d6e97c79e32e608edf86cd9',
'5d84e980461db70510115169',
'5dc5e50033233000291b05d0',
'5dcb2b6c389c0c01fb9e56dc',
'5dfa8c6fbea911088ca581d2',
'5dfb933afe28ce0e16717cae',
'5dfd175a7fb7c600354996fb',
'5e25d184e8164e002e0499d5',
'5e73c93c52002b011936efbe',
'5e75181c83e15e002fb1bd1d',
'5e78cdd87936d800303e930f',
'5e78cf4f422505034e76f218',
'5e78d972395d0a044604243c',
'5e8602993be72b00bb1106e5',
'5e894fbb94804002550b3ba2',
'5e8b4870e49e87002dacf553',
'5e8cd0fee36c6f008f81bc39',
'5ecedbfeeb0b27003ec6a5b6',
'5ee7edc93f0e4300edee30b8',
'5f0648eb658baf00bdf217cd',
'5f0ded9865865f0034b26d5a',
'5f0f430becde9e002e1ca45a',
'5f11d4101715ee003b41aca4',
'5f11f738961aef017490c95d',
'5d7149003db4bf00a2c0ac80',
'5f342a36e5ef18003ac1b8af',
'5e875b5deb10ea008d2ccf24',
'5de6b1265b5642003d2ee873',
'5388f11a00e33b3b62000316',
'542efe54f796cc57181cb40d',
'56a56d9cd8643e22000da6c2',
'58419d143b94161e00614255',
'589356ca0a3db81f000b8169',
'59395b057bf3120021e0d7f4',
'594a53f9f2d0e900226d1106',
'5b48054c51e4450028d3553c',
'5b744d18d9ba180235e4644d',
'5b7f05a4dfa812002baa2870',
'5b8ee1e03965cb003173843e',
'5b8ee2cc30e8710048cd1a10',
'5bedc7564f876a00fb2e6a31',
'5c080a59c5b96d002f4cd927',
'5c1be26fbfa9a8002c9ad402',
'5c1bf94be4b6770102ef936d',
'5c1bffd9bfa9a8002c9b1233',
'5c5b278fe0d1e1004e614d94',
'5c6f47874ac145002df593e4',
'5c86cd7b84d6ee017a03a8bb',
'5d11045b457f5c0031d932d2',
'5d26631277dd7b01687d4b89',
'5d2f60d7def6d0006f6ce1e3',
'5d3f32992aeb1c09068bb04c',
'5d4b1814d4db210039cc7964',
'5d84e9e03807a805a97e8aee',
'5d9ce897805fc4018e28908b',
'5dc9e6b36bae3d00baa4f7fe',
'5dd2cd22129c8c0031b1c3ce',
'5dfa97a920b237002b2f3c5f',
'5e541cae206f96003528ac41',
'5e680d5de1cdca00de1e2360',
'5e74f18f181bfd021815cb44',
'5e84de2af1ca19007c8547b6',
'5eaccaf086e8ad00b8778c70',
'5eb5893b3ce5c600c1eef460',
'5ecfd32152c1bb002f24a077',
'5ed91f6cbdd397002ea8c7d4',
'5eda75a129f99e0034048782',
'5edfbe2fafdeab002e92b4cb',
'5efb7054d7d8f50035c4d47f',
'5f03d5a779490e0519930dbe',
'5f0637da54aced0081486d1b',
'5f0cc64a69ce6d028de69e28',
'5f0defd8548fa5004019795a',
'5f0f5d3de0804d0079edcef8',
'5f1075547ed44d0034ecc17c',
'5f11df0b2b778700ba666b7f',
'5f32e8697f4f6400330fb324',
'5a0f7aabbe255a00475422f6',
'5cc22946d4dee900bf31dfe2')
)
SELECT user_id, login__ifit__email, ROUND(sum(duration / 60000),2) AS total_wkout_min
FROM (
select login__ifit__email, ul.*
from prodmongo.users
join unique_logs ul on users._id = ul.user_id
left JOIN testers_actuals on ul.user_id = testers_actuals.user_id
WHERE CONVERT_TIMEZONE('America/Denver',ul."start")::date BETWEEN '2020-09-07' AND '2020-09-13'
AND (login__ifit__email LIKE '%@ifit.com%'
OR login__ifit__email IN ('laurelbstewart73@gmail.com',
'joseph.chrisman@gmail.com',
'matthewt+premium@ifit.com',
'emh815@yahoo.com',
'chasewatterson@gmail.com',
'Jacob.thurman@gmail.com') )
)
GROUP BY user_id, login__ifit__email
